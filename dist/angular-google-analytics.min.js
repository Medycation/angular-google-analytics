/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.4 - 2014-08-11
 * @link http://github.com/Medycation/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-google-analytics",[]).provider("Analytics",function(){var a,b,c,d,e=!1,f=!0,g="",h=!1,i="$routeChangeSuccess",j="auto",k=!1,l=!1,m=!1,n=!0;this._logs=[],this.setAccount=function(b){return a=b,!0},this.trackPages=function(a){return f=a,!0},this.trackPrefix=function(a){return g=a,!0},this.setDomainName=function(a){return b=a,!0},this.useAnalytics=function(a){return h=!!a,!0},this.useEnhancedLinkAttribution=function(a){return l=!!a,!0},this.setPageEvent=function(a){return i=a,!0},this.setCookieConfig=function(a){return j=a,!0},this.useECommerce=function(a){return k=!!a,!0},this.setRemoveRegExp=function(a){return a instanceof RegExp?(c=a,!0):!1},this.setExperimentId=function(a){return d=a,!0},this.ignoreFirstPageLoad=function(a){m=!!a},this.ignoreDisplayFeatures=function(a){n=!!a},this.$get=["$document","$rootScope","$location","$window",function(o,p,q,r){function s(){a&&(r._gaq=[],r._gaq.push(["_setAccount",a]),l&&r._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),f&&!m&&r._gaq.push(c?["_trackPageview",u()]:["_trackPageview"]),b&&r._gaq.push(["_setDomainName",b]),function(){var a=o[0],b=a.createElement("script");b.type="text/javascript",b.async=!0,b.src=n?("https:"==a.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js":("https:"===a.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var c=a.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}(),e=!0)}function t(){if(!a)return console.warn("No account id set for Analytics.js");if(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),r.ga("create",a,j),n&&r.ga("require","displayfeatures"),f&&!m&&r.ga("send","pageview",u()),r.ga&&(k&&r.ga("require","ecommerce","ecommerce.js"),l&&r.ga("require","linkid","linkid.js"),d)){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.src="//www.google-analytics.com/cx/api.js?experiment="+d,c.parentNode.insertBefore(b,c)}}var u=function(){var a=q.path();return c?a.replace(c,""):a};this._log=function(){this._logs.push(arguments)},this._trackPage=function(a,b){b=b?b:o[0].title,f&&!h&&r._gaq?(r._gaq.push(["_set","title",b]),r._gaq.push(["_trackPageview",g+a]),this._log("_trackPageview",arguments)):f&&h&&r.ga&&(r.ga("send","pageview",{page:g+a,title:b}),this._log("pageview",arguments))},this._trackEvent=function(a,b,c,d){!h&&r._gaq?(r._gaq.push(["_trackEvent",a,b,c,d]),this._log("trackEvent",arguments)):r.ga&&(r.ga("send","event",a,b,c,d),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e,f,g,i,j){!h&&r._gaq?(r._gaq.push(["_addTrans",a,b,c,d,e,f,g,i]),this._log("_addTrans",arguments)):r.ga&&(k?(r.ga("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,tax:d,shipping:e,currency:j||"USD"}),this._log("ecommerce:addTransaction",arguments)):console.warn("ecommerce no set. Use AnalyticsProvider.setECommerce(true);"))},this._addItem=function(a,b,c,d,e,f){!h&&r._gaq?(r._gaq.push(["_addItem",a,b,c,d,e,f]),this._log("_addItem",arguments)):r.ga&&(r.ga("ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){!h&&r._gaq?(r._gaq.push(["_trackTrans"]),this._log("_trackTrans",arguments)):r.ga&&(r.ga("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){r.ga&&(r.ga("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._send=function(a){r.ga&&(r.ga("send",a),this._log("send",a))},this._set=function(a,b){r.ga&&(r.ga("set",a,b),this._log("set",a,b))},h?t():s();var v=this;return f&&p.$on(i,function(){v._trackPage(u())}),{_logs:v._logs,cookieConfig:j,ecommerce:k,enhancedLinkAttribution:l,getUrl:u,experimentId:d,ignoreFirstPageLoad:m,trackPage:function(a,b){v._trackPage(a,b)},trackEvent:function(a,b,c,d){v._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e,f,g,h,i){v._addTrans(a,b,c,d,e,f,g,h,i)},addItem:function(a,b,c,d,e,f){v._addItem(a,b,c,d,e,f)},trackTrans:function(){v._trackTrans()},clearTrans:function(){v._clearTrans()},send:function(a){v._send(a)},set:function(a,b){v._set(a,b)}}}]});